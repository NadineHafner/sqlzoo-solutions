<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>join</title>
  </head>
  <body>
    <a href="index.html">back</a>
    <h1>Join</h1>
    <ol>
      <li>Show the matchid and player name for all goals scored by Germany. To identify German players, check for: teamid = 'GER' <br> <br>SELECT matchid, player FROM goal
  WHERE teamid='GER'<br><br></li>
  <li>Show id, stadium, team1, team2 for just game 1012 <br><br>SELECT id,stadium,team1,team2
  FROM game where id='1012'<br><br></li>
  <li>Modify it to show the player, teamid, stadium and mdate for every German goal. <br><br>SELECT player,teamid,stadium,mdate
  FROM game JOIN goal ON (id=matchid) where teamid='GER' <br> <br></li>
  <li>Show the team1, team2 and player for every goal scored by a player called Mario player LIKE 'Mario%' <br><br>select team1, team2, player from game join goal ON (id=matchid)  b4r
where player like 'Mario%' <br> <br></li>
  <li>Show player, teamid, coach, gtime for all goals scored in the first 10 minutes gtime<=10 <br><br>SELECT player, teamid, coach, gtime
  FROM goal join eteam on (id=teamid)
 WHERE gtime<=10 <br><br></li>
 <li>List the dates of the matches and the name of the team in which 'Fernando Santos' was the team1 coach <br> <br>Select mdate, teamname from eteam join game on team1=eteam.id where coach='Fernando Santos' <br><br></li>
 <li>List the player for every goal scored in a game where the stadium was 'National Stadium, Warsaw' <br> <br>Select player from goal join game on id=matchid where stadium='National Stadium, Warsaw' <br><br></li>
 <li>Instead show the name of all players who scored a goal against Germany <br><br>SELECT distinct player
  FROM game JOIN goal ON matchid = id
    WHERE (team1='GER' AND team2=teamid) or (team2='GER' and team1=teamid) <br> <br></li>
    <li>Show teamname and the total number of goals scored.<br><br>SELECT teamname, count(*)
  FROM eteam JOIN goal ON id=teamid
 Group by teamname</li>
 <li>Show the stadium and the number of goals scored in each stadium. <br> <br>Select stadium, count(*) from game join goal on matchid = id group by stadium <br> <br></li>
 <li>For every match involving 'POL', show the matchid, date and the number of goals scored. <br> <br>SELECT matchid,mdate, count(*)
  FROM game JOIN goal ON matchid = id
 WHERE (team1 = 'POL' OR team2 = 'POL') group by matchid,mdate</li>
 <li>For every match where 'GER' scored, show matchid, match date and the number of goals scored by 'GER' <br><br>SELECT matchid,mdate, count(*)
  FROM game JOIN goal ON matchid = id
 WHERE (team1 = 'GER' OR team2 = 'GER') and teamid='GER' group by matchid,mdate <br> <br></li>
 <li>
List every match with the goals scored by each team as shown. This will use "CASE WHEN" which has not been explained in any previous exercises. <br><br>Select mdate, team1, sum(case when teamid=team1 then 1 else 0 end) as 'score1', team2, sum(case when teamid=team2 then 1 else 0 end) as 'score2' from game left join goal on matchid=id group by mdate, team1, team2 <br><br></li>
    </ol>
  </body>
</html>
